CLOUD storage has many beneﬁts, such as always-online, pay-as-you-go, and cheap [1]. During these years, more data are outsourced to public cloud for persistent storage, including personal and business documents.It bring sasecurity concern to data owners [2]–[4]: the public cloud is not trusted, and the outsourced data should not be leaked to the cloud provider without the permission from data owners. Many storage systems use server-dominated access control, like password-based [5] and certiﬁcate-based authentication [6]. They overly trust the cloud provider to protect their sensitive data. The cloud providers and their employees can read any document regardless of data owners’ access policy. Besides, the cloud provider can exaggerate the resource consumption of the ﬁle storage and charge the payers more without providing veriﬁable records [2], [7], [8], since we lack a system for veriﬁable computation of the resource usage.Relying on the existing server-dominated access control is not secure. Data owners who store ﬁles on cloud servers still want to control the access on their own hands and keep the data conﬁdential against the cloud provider and malicious users. Encryption is not sufﬁcient. To add the conﬁdentiality guarantee, data owners can encrypt the ﬁles and set an access policy so that only qualiﬁed users can decrypt the document. With Ciphertext-Policy Attribute-based Encryption (CP-ABE) [9], [10], we can have both ﬁne-grained access control and strong conﬁdentiality [11]–[16]. However, this access control is only available for data owners, which turns out to be insufﬁcient. If the cloud provider cannot authenticate users before downloading, like in many existing CP-ABE cloud storage systems [14], [15], the cloud has to allow everyone to download to ensure availability. This makes the storage system vulnerable to the resource-exhaustion attacks. If we resolve this problem by having data owners authenticate the downloaders before allowing them to download, we lose the ﬂexibility of access control from CP-ABE. Here lists the two problems should be addressed in our work: Problem I: resource-exhaustion attack. If the cloud cannot do cloud-side access control, it has to allow anyone, including malicious attackers, to freely download, although only some users can decrypt. The server is vulnerable to resource-exhaustion attacks. When malicious users launch the DoS/DDoS attacks to the cloud storage, the resource consumption will increase. Payers (in pay-as-you-go model) have to pay for the in creased consumption contributed by those attacks, which is a considerable an  un reason able ﬁnancial burden. The attack has been introduced as Economic Denial of Sustainability (EDoS) [17]–[20], which means payers are ﬁnancially attacked eventually. In addition, even ﬁles are encrypted, unauthorized downloads can reduce security by bringing convenience to to ofﬂine analysis and leaking information like ﬁle length or update frequency. Problem II: resource consumption accountability. In the pay-as-you-go model, users pay money to the cloud provider for storage services. The fee is decided by resource usage. However, CP-ABE based schemes for cloud storage access control does not make online conﬁrmations to the data owner before downloads.It is needed for the cloud service provider to prove to the payers about the actual resource usage. Otherwise, the cloud provider can charge more without being discovered [21], [22].A. Summary of Challenges and Approaches Challenge I: modeling the cloud provider. Many existing CP-ABE based schemes [11], [12], [23] model the cloudproviders (like Google, Amazon, Microsoft Azure) as semihonest adversaries or passive attackers. However, such a deﬁnition is restricted and it excludes some possible attacks in the real world, such as exaggerated resource usage. To model such attacks, we consider a less restricted security model, covert adversary, for the cloud provider [24]. In practice, the cloud services are usually provided by some big IT enterprises like Google, Amazon, Microsoft. They need to maintain good reputation and promise secure cloud storage services to their customers. If any attempt the cloud provider deviates from the protocol is supposed to be caught with a possibility (e.g. p = 0.001), the cloud provider dares not to cheat [24], [25]. Because being caught will not only violate the service contracts, but also lead to media exposure and destroys the reputation. Aware of the aftermath, the cloud provider has to refrain from attacking, as the cheating can be detected. This model, covert security, has been used in many secure systems [26], [27]. Note that the covert security model is different with the semi-honest model. The semi-honest model, which is widely used in proxies and cloud providers, is a model that resides between “malicious” and “trusted”. It models a party that observes all data, but it never executes the wrong program. Such a party will not cheat by deﬁnition, even if no other parties can detect its cheating. The covert model, which resides between “malicious” and “semi-honest”, models this party differently. It will not execute the wrong program only if there is a mechanism to detect its cheating. If no detection exists in the system, the party may even compromise the data, for example. Therefore, it is more practical for public cloud storage. Approach: model cloud providers as covert adversaries, and design protocols resilient to a covert adversary. Challenge II: compatible with existing systems. There are many constructions and variants for CP-ABE [23], [28], [29]. We don’t design a new variant of CP-ABE to resolve the ﬁrst challenge, as it is hard to achieve all the functionalities in these systems and also it’s not necessary. Besides the functionalities, some variants provide additional security and privacy guarantee. For example, the literatures [12], [16] hides the access policy. If the cloud-side access control makes the cloud provider knowing the access policy, it is not considered secure and compatible. It requires the cloudsideaccesscontroltobezero-knowledgeforarbitraryCP-ABE schemes. Approach: use CP-ABE in a syntactical and black-box way and ensure the construction not leaking policy and attributes. The system only learns whether the user is legitimate or not, and nothing else. Challenge III: minimal performance overhead. To protect the cloud storage effectively against the resource-exhaustion attack, the cloud-side access control needs to be efﬁcient and lightweight, otherwise if the cloud server spends, for example 20ms, executing the cloud-side access control, it will become a computational resource exhaustion attacks, which can be used by malicious attackers for DDoS and EDoS. The performance overhead being small also beneﬁts the data users who download the ﬁles from the cloud storage, makingthe computation not approachable to resource-limited devices. Approach: design an efﬁcient access control for the cloud provider which should not add too much overhead.B. Our work and Contribution In this paper, we combine the cloud-side access control and the existing data owner-side CP-ABE based access control, to resolve the aforementioned security problems in privacypreserving cloud storage. Our method can prevent the EDoS attacks by providing the cloud server with the ability to check whether the user is authorized in CP-ABE based scheme, without leaking other information. For our cloud-side access control, we use CP-ABE encryption/decryption game as challenge-response. While upload an encrypted ﬁle, the data owner ﬁrstly generates some random challenge plaintexts and the corresponding ciphertexts. The ciphertexts are related to the same access policy with the speciﬁc ﬁle. For an incoming data user, the cloud server asks him/her to decrypt randomly selected challenge ciphertext. If the user shows a correct result, which means he/she is authorized in CP-ABE, the cloud-side access control allows the ﬁle download. To make our solution secure and efﬁcient in real world applications, we provide two protocols of cloud-side and data owner-side combined access control. The main contribution of this work can be summarized as follows. 1) We propose a general solution to secure encrypted cloud storage to prevent the EDoS attacks, as well as have ﬁne-grained access control and resource consumption accountability. To the best of our knowledge, this is the ﬁrst work to claim that insufﬁcient cloud-side access control in encrypted cloud storage will lead to EDoS attacks and provides a practical solution. The solution can be compatible with many CP-ABE schemes. 2) For different data owner online patterns and performance concern, we provide two protocols for authentication and resource consumption accounting. We also introduce the bloom ﬁlter and the probabilistic check to improve the efﬁciency but still guarantee the security. 3) Compared with many state-of-arts constructions of encrypted cloud storage that assume the existence of a semihonest cloud provider, we use a more practical threat model where we assume the cloud provider to be a covert adversary [24], which provides higher security guarantee.C. Organization of the paper The rest of the paper is organized as follows. In Section II, we brieﬂy review the related works. In Section III, we give some preliminaries for this paper. In Section IV, we present our system model and security model. In Section V, we give our proposed scheme in details. In Section VI and VII, we have the security and performance analysis to illustrate the correctness, efﬁciency and security. Finally, we conclude the paper in Section VIII.
